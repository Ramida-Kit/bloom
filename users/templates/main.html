{% extends 'base.html' %}
{% block content %}
<div class="d-flex flex-column gap-4">
  <div class="card shadow-sm rounded-4 mb-3">
    <div class="card-header bg-light d-flex align-items-center">
      <h4 class="mb-0">Jokes & Categories</h4>
    </div>
    <div class="card-body">
      <div class="cards-container">
        <div class="card-item">
          <button class="add-blank-btn" aria-label="Add Category or Joke" id="add-category-btn">
            <span class="add-blank-icon">+</span>
          </button>
          <div class="add-blank-label">Blank</div>
        </div>
        {% for category in categories %}
          <div class="card-item">
            <a href="{% url 'category_detail' category.id %}" class="card-link">
              <div class="content-card">
                <span class="card-title">{{ category.name }}</span>
              </div>
            </a>
          </div>
        {% endfor %}
      </div>
    </div>
  </div>
  <div class="card shadow-sm rounded-4 mb-3">
    <div class="card-header bg-light d-flex align-items-center">
      <h4 class="mb-0">Joke Sets</h4>
    </div>
    <div class="card-body">
      <div class="cards-container">
        <div class="card-item">
          <button class="add-blank-btn" aria-label="Add Joke Set" id="add-joke-set-btn">
            <span class="add-blank-icon">+</span>
          </button>
          <div class="add-blank-label">Blank</div>
        </div>
        {% for joke_set in joke_sets %}
          <div class="card-item">
            <a href="{% url 'joke_sets:joke_set_detail' set_id=joke_set.id %}" class="card-link">
              <div class="content-card">
                <span class="card-title">{{ joke_set.name }}</span>
                <div class="card-subtitle">{{ joke_set.joke_items.count }} joke{{ joke_set.joke_items.count|pluralize }}</div>
                <div class="card-subtitle text-muted">{{ joke_set.total_runtime_formatted }}</div>
              </div>
            </a>
          </div>
        {% endfor %}
      </div>
    </div>
  </div>
</div>
<!-- Modal for adding category -->
<div class="modal fade" id="addCategoryModal" tabindex="-1" aria-labelledby="addCategoryModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="addCategoryModalLabel">Add New Category</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <form method="post" action="/jokes/add_category/">
        {% csrf_token %}
        <div class="modal-body">
          <div class="mb-3">
            <label for="categoryName" class="form-label">Category Name</label>
            <input type="text" class="form-control" id="categoryName" name="name" required>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="submit" class="btn btn-primary">Add Category</button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Modal for adding joke set -->
<div class="modal fade" id="addJokeSetModal" tabindex="-1" aria-labelledby="addJokeSetModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="addJokeSetModalLabel">Add New Joke Set</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <form method="post" action="{% url 'add_joke_set' %}">
        {% csrf_token %}
        <div class="modal-body">
          <div class="mb-3">
            <label for="jokeSetName" class="form-label">Joke Set Name</label>
            <input type="text" class="form-control" id="jokeSetName" name="name" required>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="submit" class="btn btn-primary">Create Joke Set</button>
        </div>
      </form>
    </div>
  </div>
</div>
<script>
document.getElementById('add-category-btn').addEventListener('click', function() {
  var modal = new bootstrap.Modal(document.getElementById('addCategoryModal'));
  modal.show();
});

document.getElementById('add-joke-set-btn').addEventListener('click', function() {
  var modal = new bootstrap.Modal(document.getElementById('addJokeSetModal'));
  modal.show();
});
</script>
<style>
  /* Container for cards that wraps and makes them uniform */
  .cards-container {
    display: flex;
    flex-wrap: wrap;
    gap: 24px;
    align-items: flex-start;
    justify-content: flex-start;
  }
  
  /* Individual card item wrapper */
  .card-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    width: 140px;
    min-width: 140px;
    max-width: 140px;
    height: 160px;
    background: #fff;
    border: 1px solid #e0e7ef;
    border-radius: 1rem;
    box-shadow: 0 2px 8px rgba(60,60,60,0.08);
    transition: box-shadow 0.2s, background 0.2s;
    position: relative;
    overflow: hidden;
  }
  
  .card-item:hover {
    box-shadow: 0 4px 16px rgba(60,60,60,0.16);
    background: #f3f6fb;
  }
  
  /* Link styling for cards */
  .card-link {
    text-decoration: none;
    color: inherit;
    display: block;
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  
  /* Content inside cards */
  .content-card {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 16px;
    text-align: center;
    width: 100%;
    height: 100%;
  }
  
  .card-title {
    font-size: 1.1rem;
    color: #4285f4;
    font-weight: 600;
    margin-bottom: 8px;
    line-height: 1.2;
    word-wrap: break-word;
    overflow-wrap: break-word;
    hyphens: auto;
  }
  
  .card-subtitle {
    font-size: 0.85rem;
    color: #666;
    font-weight: 400;
    margin-top: auto;
  }
  
  /* Add blank button styling */
  .add-blank-btn {
    background: none;
    border: none;
    border-radius: 50%;
    width: 56px;
    height: 56px;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 12px;
    cursor: pointer;
    box-shadow: 0 2px 8px rgba(60,60,60,0.10);
    background: #f8fafc;
    transition: box-shadow 0.2s, background 0.2s;
  }
  
  .add-blank-btn:hover {
    background: #e0e7ef;
    box-shadow: 0 4px 16px rgba(60,60,60,0.16);
  }
  
  .add-blank-icon {
    font-size: 2.2rem;
    color: #4285f4;
    font-weight: bold;
    line-height: 1;
  }
  
  .add-blank-label {
    font-size: 1rem;
    color: #333;
    font-weight: 500;
    letter-spacing: 0.02em;
  }
  
  /* Responsive adjustments */
  @media (max-width: 768px) {
    .cards-container {
      gap: 16px;
      justify-content: center;
    }
    
    .card-item {
      width: 120px;
      min-width: 120px;
      max-width: 120px;
      height: 140px;
    }
    
    .card-title {
      font-size: 1rem;
    }
    
    .card-subtitle {
      font-size: 0.8rem;
    }
  }
  
  @media (max-width: 480px) {
    .cards-container {
      gap: 12px;
    }
    
    .card-item {
      width: 100px;
      min-width: 100px;
      max-width: 100px;
      height: 120px;
    }
    
    .card-title {
      font-size: 0.9rem;
    }
    
    .content-card {
      padding: 12px;
    }
    
    .add-blank-btn {
      width: 48px;
      height: 48px;
      margin-bottom: 8px;
    }
    
    .add-blank-icon {
      font-size: 1.8rem;
    }
    
    .add-blank-label {
      font-size: 0.9rem;
    }
  }
</style>
{% endblock %}